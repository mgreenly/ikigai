# Maintainer: Michael Greenly <mgreenly@example.com>
pkgname=ikigai
pkgver=__VERSION__
pkgrel=1
pkgdesc="Ikigai client and server for network communication and task management"
arch=('x86_64' 'i686' 'aarch64')
url="https://github.com/mgreenly/ikigai"
license=('MIT')
depends=('talloc' 'curl' 'util-linux-libs' 'libb64')
makedepends=('gcc' 'make' 'check')
source=("${pkgname}-${pkgver}.tar.gz")
sha256sums=('SKIP')

build() {
    cd "${srcdir}/${pkgname}-${pkgver}"
    make all BUILD=release
}

# Tests are run in CI workflow before packaging, not during package build
# check() {
#     cd "${srcdir}/${pkgname}-${pkgver}"
#     make check
# }

package() {
    cd "${srcdir}/${pkgname}-${pkgver}"
    make install DESTDIR="${pkgdir}" PREFIX=/usr

    # Install license
    install -Dm644 LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"

    # Install documentation
    install -Dm644 README.md "${pkgdir}/usr/share/doc/${pkgname}/README.md"
}
