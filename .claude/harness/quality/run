#!/bin/bash
# harness/quality - Run all quality checks in sequence
#
# Runs: filesize → check → complexity → sanitize → tsan → valgrind → helgrind → coverage
# Stops on first failure.
#
# Usage: ./run [--dry-run]
#   --dry-run: Pass to all sub-tasks to identify issues without fixing

set -e

SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
HARNESS_DIR="$(dirname "$SCRIPT_DIR")"

# Pass all arguments to sub-tasks
ARGS="$@"

"$HARNESS_DIR/filesize/run" $ARGS
"$HARNESS_DIR/check/run" $ARGS
"$HARNESS_DIR/complexity/run" $ARGS
"$HARNESS_DIR/sanitize/run" $ARGS
"$HARNESS_DIR/tsan/run" $ARGS
"$HARNESS_DIR/valgrind/run" $ARGS
"$HARNESS_DIR/helgrind/run" $ARGS
"$HARNESS_DIR/coverage/run" $ARGS
